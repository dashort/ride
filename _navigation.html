<nav class="navigation">
    <a href="index.html" class="nav-button" id="nav-dashboard" data-page="dashboard" target="_top">ğŸ“Š Dashboard</a>
    <a href="requests.html" class="nav-button" id="nav-requests" data-page="requests" target="_top">ğŸ“‹ Requests</a>
    <a href="assignments.html" class="nav-button" id="nav-assignments" data-page="assignments" target="_top">ğŸï¸ Assignments</a>
    <a href="riders.html" class="nav-button" id="nav-riders" data-page="riders" target="_top">ğŸ‘¥ Riders</a>
    <a href="enhanced-rider-availability.html" class="nav-button" id="nav-availability" data-page="availability" target="_top">ğŸ—“ï¸ Availability</a>
    <a href="notifications.html" class="nav-button" id="nav-notifications" data-page="notifications" target="_top">ğŸ“± Notifications</a>
    <a href="reports.html" class="nav-button" id="nav-reports" data-page="reports" target="_top">ğŸ“Š Reports</a>
</nav>

<script>
(function() {
    // Set up navigation links
    function setLinks(base) {
        document.querySelectorAll('nav.navigation a').forEach(function(a) {
            var page = a.getAttribute('data-page');
            var href = page === 'dashboard' ? base : base + '?page=' + page;
            a.href = href;
            a.dataset.url = href;
        });
    }

    if (typeof google !== 'undefined' && google.script && google.script.run) {
        google.script.run.withSuccessHandler(setLinks).getWebAppUrl();
    } else {
        // Fallback for local testing
        document.querySelectorAll('nav.navigation a').forEach(function(a) {
            var page = a.getAttribute('data-page');
            var href;
            if (page === 'dashboard') {
                href = 'index.html';
            } else if (page === 'availability') {
                href = 'enhanced-rider-availability.html';
            } else {
                href = page + '.html';
            }
            a.href = href;
            a.dataset.url = href;
        });
    }

    // Navigation click handler
    function handleNavigation(link) {
        var url = link.dataset.url || link.getAttribute('href');
        if (!url || url === '#') return false;
        
        try {
            if (window.top !== window) {
                window.top.location.href = url;
            } else {
                window.location.href = url;
            }
        } catch (e) {
            window.location.href = url;
        }
        return false;
    }

    // Add click handlers to navigation links
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('nav.navigation a').forEach(function(link) {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                handleNavigation(this);
            });
        });
        
        console.log('ğŸ§­ Navigation initialized - NO AUTO RELOAD');
    });

    // CRITICAL: NO PAGESHOW RELOAD - Let browser handle back/forward naturally
    console.log('ğŸ“„ Navigation script loaded - back button will work normally');

    // Load floating availability widget
    setTimeout(function() {
        var script = document.createElement('script');
        script.src = 'availability-quick-widget.js';
        script.onerror = function() {
            console.log('â„¹ï¸ Availability quick widget not available');
        };
        document.head.appendChild(script);
    }, 1000);

})();

// Global navigation function (if needed by other scripts)
function navigateToPage(url) {
    if (url && url !== '#') {
        window.location.href = url;
    }
}
</script>