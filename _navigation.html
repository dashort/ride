<nav class="navigation">
    <!-- Default to local HTML files so navigation works without JavaScript -->
    <a href="index.html" class="nav-button" id="nav-dashboard" data-page="dashboard" target="_top" onclick="return handleNavigation(this);">ğŸ“Š Dashboard</a>
    <a href="requests.html" class="nav-button" id="nav-requests" data-page="requests" target="_top" onclick="return handleNavigation(this);">ğŸ“‹ Requests</a>
    <a href="assignments.html" class="nav-button" id="nav-assignments" data-page="assignments" target="_top" onclick="return handleNavigation(this);">ğŸï¸ Assignments</a>
    <a href="riders.html" class="nav-button" id="nav-riders" data-page="riders" target="_top" onclick="return handleNavigation(this);">ğŸ‘¥ Riders</a>
    <a href="notifications.html" class="nav-button" id="nav-notifications" data-page="notifications" target="_top" onclick="return handleNavigation(this);">ğŸ“± Notifications</a>
    <a href="reports.html" class="nav-button" id="nav-reports" data-page="reports" target="_top" onclick="return handleNavigation(this);">ğŸ“Š Reports</a>
</nav>
<script>
  (function() {
    function setLinks(base) {
      document.querySelectorAll('nav.navigation a').forEach(function(a) {
        var page = a.getAttribute('data-page');
        var href = page === 'dashboard' ? base : base + '?page=' + page;
        a.href = href;
        a.dataset.url = href;
      });
    }

    if (typeof google !== 'undefined' && google.script && google.script.run) {
      google.script.run.withSuccessHandler(setLinks).getWebAppUrl();
    } else {
      // When running locally, link directly to HTML files
      document.querySelectorAll('nav.navigation a').forEach(function(a) {
        var page = a.getAttribute('data-page');
        var href = page === 'dashboard' ? 'index.html' : page + '.html';
        a.href = href;
        a.dataset.url = href;
      });
    }
  })();

  function handleNavigation(link) {
    var url = link.dataset.url || link.getAttribute('href');
    if (!url || url === '#') return false;
    try {
      window.top.location.assign(url);
    } catch (e) {
      window.location.assign(url);
    }
    return false;
  }

  function navigateToPage(url) {
    if (url && url !== '#') {
      window.location.assign(url);
    }
  }

  // Reload the page when navigating back/forward to avoid blank screens
  // Some browsers do not set evt.persisted so also check the navigation type
  window.addEventListener('pageshow', function(evt) {
    var navType;
    try {
      if (performance.getEntriesByType) {
        var entries = performance.getEntriesByType('navigation');
        navType = entries.length > 0 ? entries[0].type : undefined;
      } else if (performance.navigation) {
        if (performance.navigation.type === 2) navType = 'back_forward';
        else if (performance.navigation.type === 1) navType = 'reload';
        else navType = 'navigate';
      }
    } catch (e) {
      navType = undefined;
    }
    if (evt.persisted || navType === 'back_forward') {
      window.location.reload();
    }
  });
</script>
// 617
